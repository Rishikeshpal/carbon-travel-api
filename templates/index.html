<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carbon Travel Intelligence</title>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-card: #1a1a25;
            --bg-card-hover: #222230;
            --accent-1: #00d4aa;
            --accent-2: #7c3aed;
            --accent-3: #3b82f6;
            --gradient-1: linear-gradient(135deg, #00d4aa 0%, #00a885 100%);
            --gradient-2: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%);
            --gradient-3: linear-gradient(135deg, #3b82f6 0%, #06b6d4 100%);
            --gradient-glow: linear-gradient(135deg, rgba(0,212,170,0.15) 0%, rgba(124,58,237,0.15) 100%);
            --text-primary: #ffffff;
            --text-secondary: #a1a1aa;
            --text-muted: #71717a;
            --border: #27272a;
            --success: #22c55e;
            --warning: #f59e0b;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: var(--bg-primary);
            min-height: 100vh;
            color: var(--text-primary);
            background-image: 
                radial-gradient(ellipse at 20% 0%, rgba(0,212,170,0.08) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 100%, rgba(124,58,237,0.08) 0%, transparent 50%);
        }

        /* Header */
        .header {
            background: rgba(10, 10, 15, 0.8);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border);
            padding: 1.25rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            gap: 0.5rem;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: var(--gradient-1);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }

        .logo-text {
            font-family: 'Space Grotesk', sans-serif;
            font-weight: 700;
            font-size: 1.25rem;
            background: linear-gradient(135deg, #fff 0%, #a1a1aa 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header-tagline {
            font-size: 0.85rem;
            color: var(--text-muted);
            letter-spacing: 0.1em;
        }

        /* Tabs */
        .tabs {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            padding: 1.5rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .tab {
            padding: 0.75rem 1.5rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-secondary);
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tab:hover {
            background: var(--bg-card-hover);
            border-color: var(--accent-1);
            color: var(--text-primary);
        }

        .tab.active {
            background: var(--gradient-1);
            border-color: transparent;
            color: #000;
        }

        .tab.train-tab.active {
            background: var(--gradient-2);
            color: #fff;
        }

        /* Container */
        .container {
            max-width: 700px;
            margin: 0 auto;
            padding: 0 1.5rem 2rem;
        }

        /* Cards */
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }

        .card:hover {
            border-color: rgba(0,212,170,0.3);
            box-shadow: 0 0 30px rgba(0,212,170,0.05);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1.25rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }

        .card-icon {
            width: 36px;
            height: 36px;
            background: var(--gradient-glow);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
        }

        .card-title {
            font-family: 'Space Grotesk', sans-serif;
            font-weight: 600;
            font-size: 1rem;
            color: var(--text-primary);
        }

        /* Forms */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 1rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .form-group label {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        input, select {
            width: 100%;
            padding: 0.875rem 1rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 0.95rem;
            font-family: inherit;
            transition: all 0.2s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: var(--accent-1);
            box-shadow: 0 0 0 3px rgba(0,212,170,0.15);
        }

        select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%2371717a' viewBox='0 0 16 16'%3E%3Cpath d='M8 11L3 6h10l-5 5z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            padding-right: 2.5rem;
        }

        .airport-input {
            font-family: 'Space Grotesk', monospace;
            font-size: 1.5rem;
            font-weight: 700;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            background: var(--bg-primary);
        }

        /* Route Row */
        .route-row {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 1rem;
            align-items: end;
            margin-bottom: 1.5rem;
        }

        .route-arrow {
            width: 50px;
            height: 50px;
            background: var(--gradient-1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            color: #000;
            margin-bottom: 0.25rem;
        }

        /* Toggle Sections */
        .toggle-section {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1rem 1.25rem;
            margin-bottom: 0.75rem;
        }

        .toggle-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
        }

        .toggle-header h4 {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .toggle-switch {
            width: 48px;
            height: 26px;
            background: var(--bg-card);
            border-radius: 13px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            top: 3px;
            left: 3px;
            width: 20px;
            height: 20px;
            background: var(--text-muted);
            border-radius: 50%;
            transition: all 0.3s;
        }

        .toggle-switch.active {
            background: var(--accent-1);
        }

        .toggle-switch.active::after {
            transform: translateX(22px);
            background: #000;
        }

        .toggle-content {
            display: none;
            margin-top: 1.25rem;
            padding-top: 1.25rem;
            border-top: 1px solid var(--border);
        }

        .toggle-content.show { display: block; }

        /* Buttons */
        .btn {
            width: 100%;
            padding: 1rem 2rem;
            border: none;
            border-radius: 14px;
            font-size: 1rem;
            font-weight: 600;
            font-family: 'Space Grotesk', sans-serif;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--gradient-1);
            color: #000;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 40px rgba(0,212,170,0.3);
        }

        .btn-secondary {
            background: var(--gradient-2);
            color: #fff;
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 40px rgba(124,58,237,0.3);
        }

        /* Quick Routes */
        .quick-routes {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 1.25rem;
        }

        .quick-route {
            padding: 0.5rem 1rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 20px;
            color: var(--text-secondary);
            font-size: 0.8rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            font-family: inherit;
        }

        .quick-route:hover {
            border-color: var(--accent-1);
            color: var(--accent-1);
            background: rgba(0,212,170,0.1);
        }

        /* Tab Content */
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.3s ease; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Results */
        .results-container { display: none; }
        .results-container.show { display: block; animation: fadeIn 0.4s ease; }

        .result-hero {
            background: var(--gradient-glow);
            border: 1px solid var(--border);
            border-radius: 24px;
            padding: 2.5rem;
            text-align: center;
            margin-bottom: 1.5rem;
            position: relative;
            overflow: hidden;
        }

        .result-hero::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(0,212,170,0.1) 0%, transparent 50%);
            animation: pulse 4s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.5; }
            50% { transform: scale(1.1); opacity: 1; }
        }

        .result-hero .big-number {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 4rem;
            font-weight: 700;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1;
            position: relative;
        }

        .result-hero .unit {
            font-size: 1.25rem;
            color: var(--text-secondary);
            margin-top: 0.5rem;
        }

        .result-hero .label {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-top: 0.5rem;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1.25rem;
            text-align: center;
        }

        .stat-card .icon {
            font-size: 1.75rem;
            margin-bottom: 0.5rem;
        }

        .stat-card .value {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .stat-card .label {
            font-size: 0.7rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-top: 0.25rem;
        }

        /* Breakdown */
        .breakdown {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            overflow: hidden;
        }

        .breakdown-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.25rem;
            border-bottom: 1px solid var(--border);
            font-size: 0.9rem;
        }

        .breakdown-item:last-child {
            border-bottom: none;
            background: var(--bg-secondary);
            font-weight: 600;
        }

        .breakdown-item span:first-child {
            color: var(--text-secondary);
        }

        .breakdown-item span:last-child {
            color: var(--text-primary);
            font-family: 'Space Grotesk', sans-serif;
        }

        /* Train Card */
        .train-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 24px;
            overflow: hidden;
            margin-bottom: 1rem;
        }

        .train-header {
            background: var(--gradient-2);
            padding: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .train-route-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
        }

        .train-operator {
            background: rgba(255,255,255,0.2);
            padding: 0.375rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .train-details { padding: 1.5rem; }

        .train-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .train-stat {
            text-align: center;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 12px;
        }

        .train-stat .value {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--accent-2);
        }

        .train-stat .label {
            font-size: 0.7rem;
            color: var(--text-muted);
            text-transform: uppercase;
            margin-top: 0.25rem;
        }

        /* Stations Timeline */
        .stations-box {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 1.25rem;
            margin-bottom: 1rem;
        }

        .stations-title {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 1rem;
        }

        .station-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            align-items: center;
        }

        .station {
            padding: 0.5rem 0.875rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .station.endpoint {
            background: var(--gradient-2);
            border: none;
            color: #fff;
        }

        .station-arrow {
            color: var(--text-muted);
            font-size: 0.75rem;
        }

        /* Comparison Box */
        .comparison-box {
            background: linear-gradient(135deg, rgba(0,212,170,0.1) 0%, rgba(124,58,237,0.1) 100%);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1.5rem;
            margin-top: 1rem;
        }

        .comparison-title {
            font-weight: 600;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .comparison-item {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1.25rem;
            text-align: center;
        }

        .comparison-item .mode { font-size: 2.5rem; }
        
        .comparison-item .emissions {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            margin-top: 0.5rem;
        }

        .comparison-item .label {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-top: 0.25rem;
        }

        .comparison-item.winner {
            border-color: var(--accent-1);
            position: relative;
        }

        .comparison-item.winner::after {
            content: '‚úì Greener';
            position: absolute;
            top: -10px;
            right: 10px;
            background: var(--accent-1);
            color: #000;
            padding: 0.25rem 0.75rem;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .savings-banner {
            background: var(--gradient-1);
            color: #000;
            padding: 1.25rem;
            border-radius: 12px;
            text-align: center;
        }

        .savings-banner .big {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
        }

        /* Booking Section */
        .booking-section {
            background: linear-gradient(135deg, rgba(124,58,237,0.1) 0%, rgba(59,130,246,0.1) 100%);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 1.5rem;
            margin-top: 1.5rem;
        }

        .booking-title {
            font-family: 'Space Grotesk', sans-serif;
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 1rem;
        }

        .booking-route-box {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
            text-align: center;
        }

        .booking-route-label {
            font-size: 0.7rem;
            color: var(--text-muted);
            text-transform: uppercase;
            margin-bottom: 0.5rem;
        }

        .booking-route-stations {
            font-family: 'Space Grotesk', sans-serif;
            font-weight: 600;
            font-size: 1rem;
        }

        .booking-route-stations .station-name {
            color: var(--accent-2);
        }

        .booking-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 0.75rem;
        }

        .booking-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 14px;
            text-decoration: none;
            color: var(--text-primary);
            transition: all 0.2s;
        }

        .booking-link:hover {
            border-color: var(--accent-2);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(124,58,237,0.2);
        }

        .booking-link .logo {
            font-size: 1.5rem;
            width: 40px;
            height: 40px;
            background: var(--bg-secondary);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .booking-link .info { flex: 1; }
        .booking-link .name { font-weight: 600; font-size: 0.9rem; }
        .booking-link .desc { font-size: 0.7rem; color: var(--text-muted); margin-top: 0.125rem; }
        .booking-link .arrow { color: var(--text-muted); }

        .booking-link.recommended {
            border-color: var(--accent-2);
            background: rgba(124,58,237,0.1);
        }

        /* Loading */
        .loading {
            display: none;
            text-align: center;
            padding: 4rem 2rem;
        }

        .loading.show { display: block; }

        .spinner {
            width: 50px;
            height: 50px;
            border: 3px solid var(--border);
            border-top-color: var(--accent-1);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1.5rem;
        }

        @keyframes spin { to { transform: rotate(360deg); } }

        .loading p {
            color: var(--text-secondary);
            font-size: 0.95rem;
        }

        /* No Route */
        .no-route {
            text-align: center;
            padding: 3rem;
            color: var(--text-secondary);
        }

        .no-route .icon { font-size: 4rem; margin-bottom: 1rem; }

        /* Footer */
        .footer {
            text-align: center;
            padding: 2rem;
            color: var(--text-muted);
            font-size: 0.75rem;
            border-top: 1px solid var(--border);
            margin-top: 2rem;
        }

        .footer a {
            color: var(--accent-1);
            text-decoration: none;
        }

        /* Responsive */
        @media (max-width: 640px) {
            .form-grid { grid-template-columns: 1fr 1fr; }
            .stats-grid { grid-template-columns: 1fr; }
            .train-stats { grid-template-columns: repeat(2, 1fr); }
            .result-hero .big-number { font-size: 3rem; }
            .tabs { flex-wrap: wrap; }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">üåç</div>
                <span class="logo-text">Carbon Travel Intelligence</span>
            </div>
            <div class="header-tagline">Calculate ‚Ä¢ Compare ‚Ä¢ Reduce</div>
        </div>
    </header>

    <!-- Tabs -->
    <div class="tabs">
        <button class="tab active" onclick="switchTab('flight')">‚úàÔ∏è Flight Calculator</button>
        <button class="tab train-tab" onclick="switchTab('train')">üöÇ European Trains</button>
    </div>

    <div class="container">
        <!-- FLIGHT TAB -->
        <div id="flightTab" class="tab-content active">
            <div id="calculatorForm">
                <!-- Quick Routes -->
                <div class="quick-routes">
                    <button class="quick-route" onclick="setRoute('DUB', 'SIN')">üáÆüá™ Dublin ‚Üí Singapore</button>
                    <button class="quick-route" onclick="setRoute('LHR', 'CDG')">üá¨üáß London ‚Üí Paris</button>
                    <button class="quick-route" onclick="setRoute('LHR', 'JFK')">üá¨üáß London ‚Üí NYC</button>
                    <button class="quick-route" onclick="setRoute('FRA', 'SIN')">üá©üá™ Frankfurt ‚Üí Singapore</button>
                </div>

                <!-- Flight Card -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">‚úàÔ∏è</div>
                        <span class="card-title">Flight Details</span>
                    </div>

                    <div class="route-row">
                        <div class="form-group">
                            <label>From</label>
                            <input type="text" id="origin" class="airport-input" placeholder="LHR" maxlength="3">
                        </div>
                        <div class="route-arrow">‚Üí</div>
                        <div class="form-group">
                            <label>To</label>
                            <input type="text" id="destination" class="airport-input" placeholder="CDG" maxlength="3">
                        </div>
                    </div>

                    <div class="form-grid">
                        <div class="form-group">
                            <label>Trip Type</label>
                            <select id="tripType">
                                <option value="oneway">One Way</option>
                                <option value="return" selected>Return</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Class</label>
                            <select id="cabinClass">
                                <option value="economy" selected>Economy</option>
                                <option value="premium_economy">Premium Economy</option>
                                <option value="business">Business</option>
                                <option value="first">First Class</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Passengers</label>
                            <select id="passengers">
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Hotel Toggle -->
                <div class="toggle-section">
                    <div class="toggle-header" onclick="toggleSection('hotel')">
                        <h4><span>üè®</span> Add Hotel Stay</h4>
                        <div class="toggle-switch" id="hotelToggle"></div>
                    </div>
                    <div class="toggle-content" id="hotelContent">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>City</label>
                                <input type="text" id="hotelCity" placeholder="Paris">
                            </div>
                            <div class="form-group">
                                <label>Country</label>
                                <select id="hotelCountry">
                                    <option value="FR">France</option>
                                    <option value="GB">UK</option>
                                    <option value="DE">Germany</option>
                                    <option value="US">USA</option>
                                    <option value="SG">Singapore</option>
                                    <option value="NL">Netherlands</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Nights</label>
                                <select id="hotelNights">
                                    <option value="1">1</option>
                                    <option value="2" selected>2</option>
                                    <option value="3">3</option>
                                    <option value="5">5</option>
                                    <option value="7">7</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Star Rating</label>
                                <select id="hotelStars">
                                    <option value="3">‚≠ê‚≠ê‚≠ê</option>
                                    <option value="4" selected>‚≠ê‚≠ê‚≠ê‚≠ê</option>
                                    <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Rooms</label>
                                <select id="hotelRooms">
                                    <option value="1" selected>1</option>
                                    <option value="2">2</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Breakfast</label>
                                <select id="hotelBreakfast">
                                    <option value="none">None</option>
                                    <option value="continental">Continental</option>
                                    <option value="buffet" selected>Buffet</option>
                                    <option value="vegan">Vegan</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Transport Toggle -->
                <div class="toggle-section">
                    <div class="toggle-header" onclick="toggleSection('transfer')">
                        <h4><span>üöï</span> Add Airport Transfer</h4>
                        <div class="toggle-switch" id="transferToggle"></div>
                    </div>
                    <div class="toggle-content" id="transferContent">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Vehicle</label>
                                <select id="transferType">
                                    <option value="taxi">Taxi</option>
                                    <option value="uber_x" selected>Uber</option>
                                    <option value="electric_uber">Electric</option>
                                    <option value="metro">Metro</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Direction</label>
                                <select id="transferDirection">
                                    <option value="both" selected>Round Trip</option>
                                    <option value="arrival">One Way</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- City Transport Toggle -->
                <div class="toggle-section">
                    <div class="toggle-header" onclick="toggleSection('cityTransport')">
                        <h4><span>üöó</span> Add City Transport</h4>
                        <div class="toggle-switch" id="cityTransportToggle"></div>
                    </div>
                    <div class="toggle-content" id="cityTransportContent">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Type</label>
                                <select id="cityVehicleType">
                                    <option value="uber_x" selected>Uber</option>
                                    <option value="taxi">Taxi</option>
                                    <option value="metro">Metro</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Est. KM</label>
                                <select id="cityKm">
                                    <option value="10">~10 km</option>
                                    <option value="25">~25 km</option>
                                    <option value="50" selected>~50 km</option>
                                    <option value="100">~100 km</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="calculate()">
                    üåç Calculate Carbon Footprint
                </button>
            </div>

            <!-- Loading -->
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Calculating your carbon footprint...</p>
            </div>

            <!-- Results -->
            <div class="results-container" id="results">
                <div class="result-hero">
                    <div class="big-number" id="totalEmissions">0</div>
                    <div class="unit">kg CO‚ÇÇe</div>
                    <div class="label" id="tripLabel">Total Trip Emissions</div>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="icon">üå≥</div>
                        <div class="value" id="treesNeeded">0</div>
                        <div class="label">Trees to Offset</div>
                    </div>
                    <div class="stat-card">
                        <div class="icon">üöó</div>
                        <div class="value" id="drivingKm">0</div>
                        <div class="label">KM Driving Equiv.</div>
                    </div>
                    <div class="stat-card">
                        <div class="icon">üì∫</div>
                        <div class="value" id="streamingHours">0</div>
                        <div class="label">Hours Netflix</div>
                    </div>
                </div>

                <div class="breakdown">
                    <div class="breakdown-item" id="flightRow">
                        <span>‚úàÔ∏è Flights</span>
                        <span id="flightValue">0 kg</span>
                    </div>
                    <div class="breakdown-item" id="hotelRow" style="display: none;">
                        <span>üè® Hotel + Breakfast</span>
                        <span id="hotelValue">0 kg</span>
                    </div>
                    <div class="breakdown-item" id="transportRow" style="display: none;">
                        <span>üöï Ground Transport</span>
                        <span id="transportValue">0 kg</span>
                    </div>
                    <div class="breakdown-item">
                        <span>Total Emissions</span>
                        <span id="totalValue">0 kg</span>
                    </div>
                </div>

                <button class="btn btn-secondary" onclick="resetForm()" style="margin-top: 1.5rem;">
                    ‚Üê Calculate Another Trip
                </button>
            </div>
        </div>

        <!-- TRAIN TAB -->
        <div id="trainTab" class="tab-content">
            <div id="trainForm">
                <div class="quick-routes">
                    <button class="quick-route" onclick="setTrainRoute('LHR', 'CDG')">üá¨üáß London ‚Üí Paris</button>
                    <button class="quick-route" onclick="setTrainRoute('LHR', 'AMS')">üá¨üáß London ‚Üí Amsterdam</button>
                    <button class="quick-route" onclick="setTrainRoute('CDG', 'AMS')">üá´üá∑ Paris ‚Üí Amsterdam</button>
                    <button class="quick-route" onclick="setTrainRoute('FRA', 'MUC')">üá©üá™ Frankfurt ‚Üí Munich</button>
                    <button class="quick-route" onclick="setTrainRoute('MAD', 'BCN')">üá™üá∏ Madrid ‚Üí Barcelona</button>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">üöÇ</div>
                        <span class="card-title">European Train Route</span>
                    </div>

                    <div class="route-row">
                        <div class="form-group">
                            <label>From</label>
                            <input type="text" id="trainOrigin" class="airport-input" placeholder="LHR" maxlength="3">
                        </div>
                        <div class="route-arrow" style="background: var(--gradient-2);">‚Üí</div>
                        <div class="form-group">
                            <label>To</label>
                            <input type="text" id="trainDestination" class="airport-input" placeholder="CDG" maxlength="3">
                        </div>
                    </div>

                    <button class="btn btn-secondary" onclick="searchTrain()">
                        üöÇ Find Train Route & Compare
                    </button>
                </div>
            </div>

            <!-- Train Loading -->
            <div class="loading" id="trainLoading">
                <div class="spinner" style="border-top-color: var(--accent-2);"></div>
                <p>Searching European train routes...</p>
            </div>

            <!-- Train Results -->
            <div class="results-container" id="trainResults">
                <div id="trainResultContent"></div>
                <button class="btn btn-secondary" onclick="resetTrainForm()" style="margin-top: 1.5rem;">
                    ‚Üê Search Another Route
                </button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        Data aligned with <a href="https://www.icao.int" target="_blank">ICAO</a>, 
        <a href="https://www.gov.uk/government/publications/greenhouse-gas-reporting-conversion-factors-2024" target="_blank">DEFRA 2024</a> & 
        <a href="https://uic.org" target="_blank">UIC</a>
    </footer>

    <script>
        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            if (tab === 'train') {
                document.querySelector('.train-tab').classList.add('active');
                document.getElementById('trainTab').classList.add('active');
            } else {
                document.querySelector('.tab:not(.train-tab)').classList.add('active');
                document.getElementById('flightTab').classList.add('active');
            }
        }

        // Section state
        const sections = { hotel: false, transfer: false, cityTransport: false };

        const airportCountries = {
            'LHR': 'GB', 'CDG': 'FR', 'JFK': 'US', 'DUB': 'IE', 'SIN': 'SG',
            'FRA': 'DE', 'MUC': 'DE', 'AMS': 'NL', 'DXB': 'AE', 'NRT': 'JP'
        };

        const airportCities = {
            'LHR': 'London', 'CDG': 'Paris', 'JFK': 'New York', 'DUB': 'Dublin',
            'SIN': 'Singapore', 'FRA': 'Frankfurt', 'MUC': 'Munich', 'AMS': 'Amsterdam'
        };

        function setRoute(origin, dest) {
            document.getElementById('origin').value = origin;
            document.getElementById('destination').value = dest;
            if (airportCities[dest]) document.getElementById('hotelCity').value = airportCities[dest];
            if (airportCountries[dest]) document.getElementById('hotelCountry').value = airportCountries[dest];
        }

        function setTrainRoute(origin, dest) {
            document.getElementById('trainOrigin').value = origin;
            document.getElementById('trainDestination').value = dest;
        }

        function toggleSection(section) {
            sections[section] = !sections[section];
            const toggle = document.getElementById(section + 'Toggle');
            const content = document.getElementById(section + 'Content');
            toggle.classList.toggle('active', sections[section]);
            content.classList.toggle('show', sections[section]);
        }

        // TRAIN SEARCH
        async function searchTrain() {
            const origin = document.getElementById('trainOrigin').value.toUpperCase().trim();
            const destination = document.getElementById('trainDestination').value.toUpperCase().trim();

            if (!origin || !destination || origin.length !== 3 || destination.length !== 3) {
                alert('Please enter valid 3-letter airport codes');
                return;
            }

            document.getElementById('trainForm').style.display = 'none';
            document.getElementById('trainLoading').classList.add('show');
            document.getElementById('trainResults').classList.remove('show');

            try {
                const response = await fetch(`/v1/trains/compare?origin=${origin}&destination=${destination}&cabin_class=economy`);
                const data = await response.json();
                displayTrainResults(data, origin, destination);
            } catch (error) {
                alert('Error: ' + error.message);
                document.getElementById('trainForm').style.display = 'block';
            } finally {
                document.getElementById('trainLoading').classList.remove('show');
            }
        }

        function displayTrainResults(data, origin, destination) {
            document.getElementById('trainResults').classList.add('show');
            const container = document.getElementById('trainResultContent');

            if (!data.train_available) {
                container.innerHTML = `
                    <div class="no-route">
                        <div class="icon">üöÇ‚ùå</div>
                        <h3>No Direct Train Route Found</h3>
                        <p style="margin-top: 1rem;">${origin} ‚Üí ${destination}</p>
                        <p style="margin-top: 0.5rem; font-size: 0.9rem; color: var(--text-muted);">
                            ${data.message || 'Try connecting trains or flight alternatives.'}
                        </p>
                    </div>
                `;
                return;
            }

            const train = data.train;
            const comp = data.comparison;
            const savings = comp.emissions.savings_percent;
            const booking = data.booking || { platforms: [] };

            const originStation = booking.platforms[0]?.origin_station || train.origin_station;
            const destStation = booking.platforms[0]?.destination_station || train.destination_station;

            let bookingHtml = '';
            if (booking.platforms && booking.platforms.length > 0) {
                bookingHtml = `
                    <div class="booking-section">
                        <div class="booking-title">üé´ Book Your Train Tickets</div>
                        
                        <div class="booking-route-box">
                            <div class="booking-route-label">Your Route</div>
                            <div class="booking-route-stations">
                                <span class="station-name">üìç ${originStation}</span>
                                <span style="color: var(--text-muted); margin: 0 0.5rem;">‚Üí</span>
                                <span class="station-name">üìç ${destStation}</span>
                            </div>
                        </div>
                        
                        <div class="booking-grid">
                            ${booking.platforms.slice(0, 5).map((p, i) => `
                                <a href="${p.url}" target="_blank" rel="noopener" class="booking-link ${i === 0 ? 'recommended' : ''}">
                                    <div class="logo">${p.logo}</div>
                                    <div class="info">
                                        <div class="name">${p.platform}</div>
                                        <div class="desc">${p.description.substring(0, 35)}...</div>
                                    </div>
                                    <div class="arrow">‚Üó</div>
                                </a>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            container.innerHTML = `
                <div class="train-card">
                    <div class="train-header">
                        <div class="train-route-title">${data.route.origin_city} ‚Üí ${data.route.destination_city}</div>
                        <div class="train-operator">${train.operator}</div>
                    </div>
                    <div class="train-details">
                        <div class="train-stats">
                            <div class="train-stat">
                                <div class="value">${train.duration}</div>
                                <div class="label">Duration</div>
                            </div>
                            <div class="train-stat">
                                <div class="value">${train.stations.count}</div>
                                <div class="label">Stations</div>
                            </div>
                            <div class="train-stat">
                                <div class="value">${comp.distance.train_km}</div>
                                <div class="label">KM</div>
                            </div>
                            <div class="train-stat">
                                <div class="value">${train.high_speed ? '‚ö°' : 'üöÉ'}</div>
                                <div class="label">${train.high_speed ? 'High Speed' : 'Regional'}</div>
                            </div>
                        </div>

                        <div class="stations-box">
                            <div class="stations-title">üöâ Route Stations</div>
                            <div class="station-list">
                                ${train.stations.list.map((s, i) => `
                                    ${i > 0 ? '<span class="station-arrow">‚Üí</span>' : ''}
                                    <span class="station ${i === 0 || i === train.stations.list.length - 1 ? 'endpoint' : ''}">${s}</span>
                                `).join('')}
                            </div>
                        </div>

                        <div class="stations-box">
                            <div class="stations-title">üïê Departures (${train.schedule.frequency})</div>
                            <div class="station-list">
                                ${train.schedule.sample_departures.map(t => `
                                    <span class="station">${t}</span>
                                `).join('')}
                            </div>
                        </div>

                        <div class="comparison-box">
                            <div class="comparison-title">‚öñÔ∏è Train vs Flight</div>
                            <div class="comparison-grid">
                                <div class="comparison-item winner">
                                    <div class="mode">üöÇ</div>
                                    <div class="emissions">${comp.emissions.train_kg} kg</div>
                                    <div class="label">Train CO‚ÇÇe</div>
                                </div>
                                <div class="comparison-item">
                                    <div class="mode">‚úàÔ∏è</div>
                                    <div class="emissions">${comp.emissions.flight_kg} kg</div>
                                    <div class="label">Flight CO‚ÇÇe</div>
                                </div>
                            </div>
                            <div class="savings-banner">
                                <div class="big">üå± Save ${savings}% CO‚ÇÇ</div>
                                <div>Train saves ${comp.emissions.savings_kg} kg per passenger</div>
                            </div>
                        </div>

                        ${bookingHtml}
                    </div>
                </div>
            `;
        }

        function resetTrainForm() {
            document.getElementById('trainResults').classList.remove('show');
            document.getElementById('trainForm').style.display = 'block';
        }

        // FLIGHT CALCULATION
        async function calculate() {
            const origin = document.getElementById('origin').value.toUpperCase().trim();
            const destination = document.getElementById('destination').value.toUpperCase().trim();

            if (!origin || !destination || origin.length !== 3 || destination.length !== 3) {
                alert('Please enter valid 3-letter airport codes');
                return;
            }

            document.getElementById('calculatorForm').style.display = 'none';
            document.getElementById('loading').classList.add('show');
            document.getElementById('results').classList.remove('show');

            const segments = [];
            const cabinClass = document.getElementById('cabinClass').value;
            const passengers = parseInt(document.getElementById('passengers').value);
            const isReturn = document.getElementById('tripType').value === 'return';

            const today = new Date();
            const departDate = new Date(today);
            departDate.setDate(departDate.getDate() + 7);

            segments.push({
                type: 'flight', origin, destination,
                departure_date: departDate.toISOString().split('T')[0],
                cabin_class: cabinClass
            });

            if (isReturn) {
                const returnDate = new Date(departDate);
                returnDate.setDate(returnDate.getDate() + 3);
                segments.push({
                    type: 'flight', origin: destination, destination: origin,
                    departure_date: returnDate.toISOString().split('T')[0],
                    cabin_class: cabinClass
                });
            }

            if (sections.hotel) {
                const nights = parseInt(document.getElementById('hotelNights').value);
                const checkOut = new Date(departDate);
                checkOut.setDate(checkOut.getDate() + nights);
                segments.push({
                    type: 'hotel',
                    location: {
                        city: document.getElementById('hotelCity').value || airportCities[destination] || destination,
                        country_code: document.getElementById('hotelCountry').value
                    },
                    check_in: departDate.toISOString().split('T')[0],
                    check_out: checkOut.toISOString().split('T')[0],
                    star_rating: parseInt(document.getElementById('hotelStars').value),
                    room_count: parseInt(document.getElementById('hotelRooms').value),
                    persons: passengers,
                    breakfast: document.getElementById('hotelBreakfast').value
                });
            }

            if (sections.transfer) {
                segments.push({
                    type: 'transfer',
                    airport: destination,
                    vehicle_type: document.getElementById('transferType').value,
                    round_trip: document.getElementById('transferDirection').value === 'both'
                });
            }

            if (sections.cityTransport) {
                segments.push({
                    type: 'transport',
                    vehicle_type: document.getElementById('cityVehicleType').value,
                    distance_km: parseInt(document.getElementById('cityKm').value)
                });
            }

            try {
                const response = await fetch('/v1/assess', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        trip_id: 'ui_' + Date.now(),
                        traveler_count: passengers,
                        segments,
                        options: { include_alternatives: true, alternative_count: 3 }
                    })
                });

                const data = await response.json();
                if (!response.ok) throw new Error(data.message || 'Calculation failed');
                displayResults(data, isReturn, passengers);
            } catch (error) {
                alert('Error: ' + error.message);
                document.getElementById('calculatorForm').style.display = 'block';
            } finally {
                document.getElementById('loading').classList.remove('show');
            }
        }

        function displayResults(data, isReturn, passengers) {
            document.getElementById('results').classList.add('show');
            const total = data.total_emissions;

            document.getElementById('totalEmissions').textContent = Math.round(total.co2e_kg).toLocaleString();
            document.getElementById('tripLabel').textContent = `${isReturn ? 'Return' : 'One-way'} ‚Ä¢ ${passengers} passenger${passengers > 1 ? 's' : ''}`;
            document.getElementById('treesNeeded').textContent = Math.round(total.equivalent.trees_to_offset);
            document.getElementById('drivingKm').textContent = Math.round(total.equivalent.driving_km).toLocaleString();
            document.getElementById('streamingHours').textContent = Math.round(total.equivalent.streaming_hours).toLocaleString();

            document.getElementById('flightValue').textContent = `${Math.round(total.breakdown.flights_kg).toLocaleString()} kg`;
            
            document.getElementById('hotelRow').style.display = total.breakdown.hotels_kg > 0 ? 'flex' : 'none';
            document.getElementById('hotelValue').textContent = `${Math.round(total.breakdown.hotels_kg).toLocaleString()} kg`;

            document.getElementById('transportRow').style.display = total.breakdown.transport_kg > 0 ? 'flex' : 'none';
            document.getElementById('transportValue').textContent = `${Math.round(total.breakdown.transport_kg).toLocaleString()} kg`;

            document.getElementById('totalValue').textContent = `${Math.round(total.co2e_kg).toLocaleString()} kg`;
        }

        function resetForm() {
            document.getElementById('results').classList.remove('show');
            document.getElementById('calculatorForm').style.display = 'block';
        }

        // Auto-uppercase
        ['origin', 'destination', 'trainOrigin', 'trainDestination'].forEach(id => {
            const el = document.getElementById(id);
            if (el) el.addEventListener('input', function() { this.value = this.value.toUpperCase(); });
        });
    </script>
</body>
</html>
