{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://api.carbontravelintel.io/schemas/request.json",
  "title": "Carbon Travel API - Itinerary Request",
  "description": "JSON Schema for validating carbon assessment requests",
  "type": "object",
  "required": ["segments"],
  "properties": {
    "trip_id": {
      "type": "string",
      "description": "Client-provided unique identifier for this trip",
      "maxLength": 100
    },
    "traveler_count": {
      "type": "integer",
      "minimum": 1,
      "maximum": 500,
      "default": 1,
      "description": "Number of travelers (emissions multiplied accordingly)"
    },
    "segments": {
      "type": "array",
      "minItems": 1,
      "maxItems": 50,
      "items": {
        "oneOf": [
          { "$ref": "#/definitions/FlightSegment" },
          { "$ref": "#/definitions/HotelSegment" }
        ]
      }
    },
    "options": {
      "$ref": "#/definitions/AssessmentOptions"
    }
  },
  "definitions": {
    "FlightSegment": {
      "type": "object",
      "required": ["type", "origin", "destination", "departure_date"],
      "properties": {
        "type": {
          "type": "string",
          "const": "flight"
        },
        "origin": {
          "type": "string",
          "pattern": "^[A-Z]{3}$",
          "description": "IATA airport code"
        },
        "destination": {
          "type": "string",
          "pattern": "^[A-Z]{3}$",
          "description": "IATA airport code"
        },
        "departure_date": {
          "type": "string",
          "format": "date",
          "description": "ISO 8601 date (YYYY-MM-DD)"
        },
        "departure_time": {
          "type": "string",
          "format": "time",
          "description": "Optional departure time (HH:MM)"
        },
        "cabin_class": {
          "type": "string",
          "enum": ["economy", "premium_economy", "business", "first"],
          "default": "economy"
        },
        "carrier_code": {
          "type": "string",
          "pattern": "^[A-Z0-9]{2}$",
          "description": "IATA airline code"
        },
        "flight_number": {
          "type": "string",
          "description": "Optional flight number for specific aircraft lookup"
        },
        "is_return": {
          "type": "boolean",
          "default": false,
          "description": "Flag if this is a return leg"
        }
      }
    },
    "HotelSegment": {
      "type": "object",
      "required": ["type", "location", "check_in", "check_out"],
      "properties": {
        "type": {
          "type": "string",
          "const": "hotel"
        },
        "location": {
          "type": "object",
          "required": ["country_code"],
          "properties": {
            "city": {
              "type": "string"
            },
            "country_code": {
              "type": "string",
              "pattern": "^[A-Z]{2}$",
              "description": "ISO 3166-1 alpha-2 country code"
            },
            "coordinates": {
              "type": "object",
              "properties": {
                "latitude": {
                  "type": "number",
                  "minimum": -90,
                  "maximum": 90
                },
                "longitude": {
                  "type": "number",
                  "minimum": -180,
                  "maximum": 180
                }
              }
            }
          }
        },
        "check_in": {
          "type": "string",
          "format": "date"
        },
        "check_out": {
          "type": "string",
          "format": "date"
        },
        "star_rating": {
          "type": "integer",
          "minimum": 1,
          "maximum": 5
        },
        "hotel_chain": {
          "type": "string",
          "description": "Hotel chain code for chain-specific data"
        },
        "room_count": {
          "type": "integer",
          "minimum": 1,
          "default": 1
        },
        "sustainability_certified": {
          "type": "boolean",
          "default": false
        }
      }
    },
    "AssessmentOptions": {
      "type": "object",
      "properties": {
        "include_alternatives": {
          "type": "boolean",
          "default": false
        },
        "alternative_count": {
          "type": "integer",
          "minimum": 1,
          "maximum": 10,
          "default": 3
        },
        "calculation_method": {
          "type": "string",
          "enum": ["standard", "detailed", "conservative"],
          "default": "standard"
        },
        "include_methodology": {
          "type": "boolean",
          "default": false
        }
      }
    }
  }
}
